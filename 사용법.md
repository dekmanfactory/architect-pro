# HWPX 제안서 생성 시스템 사용법

## 📋 개요

이 시스템은 **Markdown 문서를 한글 오피스(HWPX) 파일로 자동 변환**합니다.

### 특징
- ✅ **색상 자동 적용**: AI/기술 용어는 녹색, 수치/성과는 빨간색
- ✅ **표 자동 생성**: Markdown 표가 HWPX 표로 변환
- ✅ **한글 오피스 호환**: 한글 2020 이상에서 정상 표시
- ✅ **웹 미리보기 동일**: 웹에서 보이는 색상이 HWPX에도 동일하게 표시

---

## 🚀 빠른 시작

### 방법 1: 올인원 배치 파일 (추천)

```cmd
ALL_IN_ONE.bat 제안서.md
```

이 하나의 명령으로 `제안서.md` → `제안서.json` → `제안서.hwpx` 변환 완료!

### 방법 2: JSON 파일이 이미 있는 경우 (HTML 태그 포함)

웹 서비스에서 생성된 JSON에 HTML 태그가 포함된 경우:

```cmd
CLEAN_AND_GENERATE.bat proposal.json
```

이 명령으로:
1. HTML 태그를 색상 마커로 자동 변환
2. HWPX 파일 생성

**변환 예시:**
- `<span class="text-green-600">AI 분석</span>` → 녹색 텍스트
- `<span class="text-red-600">80%</span>` → 빨간색 텍스트
- `<strong>`, `<em>` 등 → 제거

### 방법 3: 단계별 실행

```cmd
# 단계 1: Markdown → JSON
1_md_to_json.bat 제안서.md

# 단계 2: JSON → HWPX
2_json_to_hwpx.bat 제안서.json
```

---

## 🎨 색상 규칙

### 자동으로 녹색이 적용되는 키워드
Markdown에서 **볼드**로 작성하면 자동으로 녹색 글자로 변환됩니다:

- **AI**, **인공지능**, **자동화**
- **머신러닝**, **딥러닝**, **알고리즘**
- **LLM**, **GPT**, **생성형**
- **리터러시**, **역량**, **기술**
- **시스템**, **솔루션**, **모델**

**예시:**
```markdown
본 사업은 **AI 기반 제안서 작성 자동화 시스템** 구축을 목표로 합니다.
```
→ "AI 기반 제안서 작성 자동화 시스템"이 **녹색**으로 표시됩니다.

### 자동으로 빨간색이 적용되는 패턴
숫자와 함께 사용되는 **볼드**는 빨간색으로 변환됩니다:

- **80%**, **50% 절감**
- **40시간**, **30분**, **5일**

**예시:**
```markdown
기존 방식 대비 **80% 이상의 시간 절감** 효과가 예상됩니다.
```
→ "80% 이상의 시간 절감"이 **빨간색**으로 표시됩니다.

### 수동으로 색상 지정하기
JSON 파일을 직접 수정할 때는 마커를 사용할 수 있습니다:

```json
{
  "level": 2,
  "text": "본 사업은 {{green:AI 기반 시스템}} 구축을 통해 {{red:80% 절감}}을 달성합니다."
}
```

---

## 📊 표 작성 방법

Markdown 표는 자동으로 HWPX 표로 변환됩니다:

```markdown
| 기능 | 기존 방식 | 신규 방식 |
|------|----------|----------|
| RFP 분석 | 수작업 (**4시간**) | **자동화 (10분)** |
| 제안서 작성 | 수작업 (30시간) | **AI 생성 (30분)** |
```

표 안에서도 **볼드**를 사용하면 색상이 자동으로 적용됩니다:
- `**4시간**` → 빨간색
- `**자동화 (10분)**` → 녹색
- `**AI 생성 (30분)**` → 녹색

---

## 📁 파일 구조

```
D:\00work\260214-hwpx-allskills\
│
├── ALL_IN_ONE.bat                    ← 올인원 실행 파일 ⭐
├── 1_md_to_json.bat                  ← 단계별: Markdown → JSON
├── 2_json_to_hwpx.bat                ← 단계별: JSON → HWPX
│
├── 제안서.md                          ← 여기에 Markdown 작성
├── 제안서.json                        ← 자동 생성됨
├── 제안서.hwpx                        ← 최종 출력 (한글 오피스로 열기)
│
├── skills/
│   ├── 3_proposal_writing/
│   │   └── markdown_to_json.py       ← Markdown → JSON 변환기
│   └── 4_hwpx_generation/
│       └── src/
│           └── hwpx_generator.py     ← JSON → HWPX 변환기
│
├── sample-from-hangul.hwpx           ← 템플릿 파일 (필수!)
├── proposal-styles.json              ← 스타일 설정
│
└── _archive/                         ← 테스트 파일 (무시)
```

---

## 💡 고급 사용법

### JSON 파일 직접 수정하기

1. Markdown → JSON 변환 후 JSON 파일 열기
2. `text` 필드에서 색상 마커 수동 추가:
   ```json
   "text": "{{green:AI 기술}}을 활용한 {{red:50% 비용 절감}}"
   ```
3. JSON → HWPX 변환

### 기존 JSON 파일 수정하기

이미 생성된 JSON에 **볼드**가 남아있다면:

```cmd
python fix_json_markers.py 제안서.json 제안서-fixed.json
```

### 표 셀에 색상 적용하기

JSON에서 표 셀 데이터를 문자열로 작성하고 마커 사용:

```json
{
  "type": "table",
  "headers": ["기능", "기존", "신규"],
  "rows": [
    [
      "분석",
      "수작업 {{red:(4시간)}}",
      "{{green:자동화 (10분)}}"
    ]
  ]
}
```

---

## ⚠️ 주의사항

### 필수 파일
- **`sample-from-hangul.hwpx`**: 한글 오피스 템플릿 파일 (없으면 한글이 안 보임!)
- **`proposal-styles.json`**: 폰트 크기/색상 설정

### 한글이 안 보일 때
1. `sample-from-hangul.hwpx` 파일이 있는지 확인
2. 한글 오피스 2020 이상 버전 사용
3. KoPubWorld 폰트 설치 확인

### 색상이 안 나올 때
1. Markdown에서 **볼드** 사용했는지 확인
2. JSON에서 마커 형식 확인: `{{green:텍스트}}` (중괄호 2개!)
3. 키워드가 녹색/빨강 규칙에 해당하는지 확인

---

## 🔍 문제 해결

### "python을 찾을 수 없습니다"
→ Python 설치 필요: https://www.python.org/downloads/

### "node를 찾을 수 없습니다"
→ Node.js 설치 필요: https://nodejs.org/

### "hwpx 모듈이 없습니다"
```cmd
pip install python-hwpx lxml
```

### "표가 안 보입니다"
→ JSON에서 `type: "table"` 확인
→ `headers`와 `rows` 배열이 올바른지 확인

---

## 📞 지원

문제가 발생하면:
1. 캡처 화면 공유
2. 사용한 Markdown/JSON 파일 공유
3. 에러 메시지 전체 복사

---

## 📚 예시

### 입력 (Markdown)
```markdown
# 과제명: AI 리터러시와 실무 적용을 위한 인공지능 기초 마스터 과정

## p1. 훈련과정의 명칭 및 기획 배경

본 훈련과정의 명칭은 **AI 기초부터 심화까지: 실생활 사례로 배우는 인공지능 리터러시 역량 강화 과정**으로 명명하였습니다.

본 과정은 현대 사회의 급격한 디지털 전환 속에서 모든 산업 분야의 실무자가 갖추어야 할 필수 소양인 인공지능(AI)에 대한 포괄적인 이해와 실무 적용 능력을 함양하는 것을 목표로 합니다.

오늘날의 경제 환경에서 인공지능은 더 이상 특정 기술 인력만의 전유물이 아닙니다. **한국의 주요 대기업 및 스타트업에서 데이터 분석 능력은 물론, AI 기술에 대한 이해(AI 리터러시)를 필수 역량으로 요구**함에 따라, 비전공자 및 기초 학습자들도 AI의 원리를 명확히 파악하고 이를 자신의 직무에 창의적으로 적용할 수 있는 능력이 절실히 요구되고 있습니다.

기존 수작업 방식 대비 **80% 이상의 시간 절감** 효과가 예상됩니다.

## 표 예시

| 기능 | 기존 방식 | 신규 방식 |
|------|----------|----------|
| RFP 분석 | 수작업 (**4시간**) | **자동화 (10분)** |
| 제안서 작성 | 수작업 (30시간) | **AI 생성 (30분)** |
```

### 출력 (HWPX)
- "AI 기초부터 심화까지" → **녹색**
- "AI 리터러시" → **녹색**
- "80% 이상의 시간 절감" → **빨간색**
- "4시간" → **빨간색**
- "자동화 (10분)" → **녹색**
- "AI 생성 (30분)" → **녹색**

---

**버전**: 1.0
**최종 수정**: 2026-02-16
